<div class="card p-6">
  <!-- Header Row: Stock In + Buttons -->
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
    <span class="block text-surface-900 font-bold text-2xl">Item Report</span>
    
    <!-- Buttons - Hidden on mobile, shown in header on desktop -->
    <div class="hidden md:flex gap-4">
      <button pButton type="submit" label="Display" class="p-button-warning" 
        (click)="Onreturndropdowndetails()" [disabled]="reportForm.invalid">
      </button>
      <button pButton type="button" label="Download" icon="pi pi-download" iconPos="right" 
        class="p-button-warning" (click)="onDownloadClick()">
      </button>
      <button pButton type="button" label="Reset" 
        class="p-button-secondary" (click)="reset()">
      </button>
    </div>
  </div>

  <form [formGroup]="reportForm" class="space-y-8">
    <!-- ðŸ· Product Info Section -->
    <div class="space-y-6">
      <!-- Report Type - Full width -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full">
        <div class="flex flex-col">
          <label class="font-medium mb-1">Report Type <span class="text-red-500">*</span></label>
          <p-dropdown
            [options]="reportTypeOptions"
            optionLabel="label"
            optionValue="value"
            [filter]="true"
            [showClear]="true"
            filterPlaceholder="Select Report Type"
            formControlName="reportType"
            placeholder="Report Type"
            (onChange)="onReportChange($event)"
            class="w-full"
          >
          </p-dropdown>
        </div>
      </div>

      <!-- Category and Item Name - Stack vertically on mobile, side by side on desktop -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full">
        <!-- Category - Full width on mobile, half on desktop -->
        <div class="flex flex-col">
          <label class="font-medium mb-1">Category</label>
          <p-dropdown [options]="categoryOptions" optionLabel="fieldname" optionValue="fieldid" 
            (onChange)="onCategoryItem($event)" [filter]="true" [showClear]="true" 
            filterPlaceholder="Search Category" formControlName="category" placeholder="Category"  
            [disabled]="!reportForm.get('reportType')?.value" class="w-full">
          </p-dropdown>
        </div>

        <!-- Item Name - Full width on mobile, half on desktop -->
        <div class="flex flex-col">
          <label class="font-medium mb-1">Item Name</label>
          <p-dropdown [options]="itemOptions" optionLabel="itemcombine" optionValue="itemid" 
            [filter]="true" [showClear]="true" filterPlaceholder="Search Item" 
            formControlName="item" placeholder="Item" [disabled]="!reportForm.get('reportType')?.value" 
            class="w-full">
          </p-dropdown>
        </div>
      </div>
    </div>

    <!-- Action Buttons - Visible only on mobile, below form fields -->
    <div class="flex md:hidden justify-center gap-2 mt-6">
      <button pButton type="submit" label="Display" class="p-button-warning flex-1" 
        (click)="Onreturndropdowndetails()" [disabled]="reportForm.invalid">
      </button>
      <button pButton type="button" label="Download"
        class="p-button-warning flex-1" (click)="onDownloadClick()">
      </button>
      <button pButton type="button" label="Reset" 
        class="p-button-secondary flex-1" (click)="reset()">
      </button>
    </div>

    <!-- Product Table with Pagination -->
    <div>
      <p-table
        [value]="filteredProducts"
        dataKey="code"
        [tableStyle]="{'min-width': '50rem'}"
        [paginator]="true"
        [rows]="10"
        [rowsPerPageOptions]="[5, 10, 20, 50]"
        [responsiveLayout]="'scroll'"
        class="p-datatable-gridlines mt-6 item-report"
      >
        <ng-template #header>
          <tr class="bg-yellow-400">
            <th>Item Code</th>
            <th>Item Name</th>
            <th>Category</th>
            <th>Stock</th>
            <th>UOM</th>
            <th>Cost Price</th>
            <th>MRP</th>
            <th>GST Item</th>
            <th>Active</th>
            <th>Warranty (in Mon)</th>
            <th>Location</th>
            <th>Last Upd By</th>
            <th>Last Upd On</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-row let-i="rowIndex">
          <tr>
            <td>{{ row.itemsku}}</td>
            <td>{{ row.itemname }}</td>
            <td>{{ row.categoryname }}</td>
            <td>{{ row.currentstock }}</td>
            <td>{{ row.uomname}}</td>
            <td>{{ row.costprice }}</td>
            <td>{{ row.saleprice}}</td>
            <td>{{ row.gstitem}}</td>
            <td>{{ row.isactive}}</td>
            <td>{{ row.warrentyperiod}}</td>
            <td>{{ row.location }}</td>
            <td>{{ row.updatedby}}</td>
            <td>{{ row.updatedon | date:'dd/MM/yyyy'}}</td>
          </tr>
        </ng-template>

        <ng-template pTemplate="paginatorleft" appendTo="body">
          <div class="total-items text-gray-600 ms-2">Total Items: {{ filteredProducts?.length || 0 }}</div>
        </ng-template>
      </p-table>
    </div>
  </form>
</div>