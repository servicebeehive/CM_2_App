<div class="card p-6">
    <!-- Header Row: Stock In + Buttons -->
    <div class="flex justify-between items-center mb-6">
        <span class="block text-surface-900 font-bold text-2xl">Invoice</span>
    </div>

    <form [formGroup]="invoiceForm" class="space-y-8">
        <!-- ðŸ· Product Info Section -->
        <div>
            <!-- Report Type -->

            <div class="grid grid-cols-2 gap-x-8 gap-y-2 w-full">
                
                <!-- Customer Mobile -->
                <div class="flex flex-col">
                    <label class="font-medium mb-1">Customer Mobile</label>
                    <p-dropdown
                        [options]="cusMobileOptions"
                        optionLabel="fieldname"
                        optionValue="fieldid"
                        [filter]="true"
                        [showClear]="true"
                        filterPlaceholder="Search Customer Mobile"
                        formControlName="p_mobile"
                        placeholder="Customer Mobile"
                    >
                    </p-dropdown>
                </div>
                <div class="flex justify-end gap-4 mt-8">
                    <button pButton type="submit" label="Display" class="p-button-warning" [disabled]="invoiceForm.invalid" (click)="display()"></button>
                    <button pButton type="button" label="Reset" class="p-button-secondary" (click)="reset()"></button>
                </div>

                <!-- Transaction Date From-->
                <div class="flex flex-col">
                    <label class="font-medium mb-1">From Date <span class="text-red-500">*</span></label>
                    <p-datepicker fluid formControlName="fromDate" [showIcon]="true" placeholder="From Date"></p-datepicker>
                    <small class="text-red-500 ms-3 mt-1" *ngIf="invoiceForm.get('fromDate')?.touched">
            <span *ngIf="invoiceForm.get('fromDate')?.errors?.['required']">From Date is required</span>
          </small>
                </div>

                <!-- Transaction Date To -->
                <div class="flex flex-col">
                    <label class="font-medium mb-1">To Date <span class="text-red-500">*</span></label>
                    <p-datepicker fluid formControlName="toDate" [showIcon]="true" placeholder="To Date"></p-datepicker>
                     <small class="text-red-500 ms-3 mt-1" *ngIf="invoiceForm.get('toDate')?.touched">
            <span *ngIf="invoiceForm.get('toDate')?.errors?.['required']">To Date is required</span>
             <span *ngIf="invoiceForm.errors?.['dateRangeInvalid'] && invoiceForm.get('toDate')?.touched">To Date must be greater than or equal to From Date</span>
          </small>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-6 flex-grow mt-4">
                <!-- Customer Name -->
                <div class="flex flex-col">
                    <label class="font-medium mb-1">Customer Name</label>
                    <p-dropdown
                        [options]="cusNameOptions"
                        optionLabel="fieldname"
                        optionValue="fieldid"
                        [filter]="true"
                        [showClear]="true"
                        filterPlaceholder="Search Customer Name"
                        formControlName="p_cusname"
                        placeholder="Customer Name"
                    >
                    </p-dropdown>
                </div>

                <div class="flex flex-col">
                    <label class="font-medium mb-1">Status</label>
                    <p-dropdown [options]="statusOptions" optionLabel="fieldname" [showClear]="true" optionValue="fieldid" [filter]="true" filterPlaceholder="Select Status" formControlName="status" placeholder="Status"> </p-dropdown>
                    <!-- <small class="text-red-500 ms-3 mt-1" *ngIf="invoiceForm.get('vendorName')?.touched">
            <span *ngIf="invoiceForm.get('vendorName')?.errors?.['required']">Vendor Name is required</span>
          </small> -->
                </div>
            </div>
        </div>

        <!-- Product Table with Pagination -->
        <div>
            <p-table [value]="filteredProducts" dataKey="code" [tableStyle]="{ 'min-width': '50rem' }" [paginator]="true" [rows]="10" [rowsPerPageOptions]="[5, 10, 20, 50]" [responsiveLayout]="'scroll'" class="p-datatable-gridlines mt-6">
                <ng-template #header>
                    <tr class="bg-yellow-400">
                        <th><p-tableHeaderCheckbox></p-tableHeaderCheckbox></th>
                        <th>Invoice No</th>
                        <th>Invoice Date</th>
                        <th>Transaction Type</th>
                        <th>Customer</th>
                        <th>Total Amount</th>
                        <th>Paid Amount</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-row let-i="rowIndex">
                    <tr>
                        <td class="text-center">
                            <p-tableCheckbox [value]="row" />
                        </td>
                        <td>{{ row.invoice_no }}</td>
                        <td>{{ row.invoice_date }}</td>
                        <td>{{ row.transactiontype}}</td>
                        <td>{{ row.customer }}</td>
                        <td>{{ row.total_amount }}</td>
                        <td>{{ row.paid_amount }}</td>
                        <td>{{ row.status }}</td>
                        <td class="text-center w-[60px]">
                            <div class="flex g-2">
                                <button pButton type="button" icon="pi pi-print" disabled class="p-button-text p-button-sm"></button>
                                <button pButton type="button" icon="pi pi-folder-open" class="p-button-text p-button-sm text-red-500"></button>
                            </div>
                        </td>
                    </tr>
                </ng-template>

                <ng-template pTemplate="paginatorleft">
                    <div class="text-gray-600 ms-2">Total Items: {{ filteredProducts?.length || 0 }}</div>
                </ng-template>
            </p-table>
        </div>

    </form>

    <!-- Confirm Dialog -->
    <p-confirmDialog></p-confirmDialog>
</div>
